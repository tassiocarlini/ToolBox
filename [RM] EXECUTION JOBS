SELECT      GJOBXEXECUCAO.IDJOB,
           GJOBX.NOME,
           GRELBATCH.DESCRELAT,
           GJOBX.CLASSEPROCESSO,
GJOBX.CODCOLIGADA,
           CASE GJOBXEXECUCAO.STATUS
WHEN 0 THEN '0 - NONE'
WHEN 1 THEN '1 - RUNNING'
WHEN 2 THEN '2 - FINISHED'
WHEN 3 THEN '3 - CANCELED'
WHEN 4 THEN '4 - STOPPED'
WHEN 5 THEN '5 - ERROR'
WHEN 6 THEN '6 - WARNING'
WHEN 7 THEN '7 - FAILED'
ELSE 'DISABLED:'END STATUS,
           GJOBX.CODSISTEMA,
           GJOBX.CODUSUARIO,
           GJOBXEXECUCAO.DATAPROGRAMADA,
           GJOBXEXECUCAO.DATAINIEXEC,
           GJOBXEXECUCAO.DATAFIMEXEC,
           GJOBXEXECUCAO.SERVIDOR,
           CONVERT(VARCHAR(12),CONVERT(TIME,GJOBXEXECUCAO.DATAINIEXEC - GJOBXEXECUCAO.DATAPROGRAMADA)) AS 'TMPFILA',
           CONVERT(VARCHAR(12),CONVERT(TIME,GJOBXEXECUCAO.DATAFIMEXEC - GJOBXEXECUCAO.DATAINIEXEC)) AS 'TMPEXECUCAO',
           CONVERT(VARCHAR(12),CONVERT(TIME,GJOBXEXECUCAO.DATAFIMEXEC - GJOBXEXECUCAO.DATAPROGRAMADA)) AS 'TMPTOTAL',
           GJOBX.TIPORECORRENCIA,
GJOBXEXECUCAO.MENSAGEMSTATUS
FROM GJOBX (NOLOCK)
     INNER JOIN GJOBXEXECUCAO (NOLOCK) ON (GJOBX.IDJOB = GJOBXEXECUCAO.IDJOB)
     LEFT JOIN GRELBATCH (NOLOCK) ON (GRELBATCH.IDJOBX = GJOBX.IDJOB)
WHERE GJOBXEXECUCAO.DATAPROGRAMADA >= GETDATE()-1 -- tempo que executou
ORDER BY GJOBX.IDJOB
DESC
GO





-- STATUS = 1 GJOBEXECUCAO
SELECT      GJOBXEXECUCAO.IDJOB,
           GJOBX.NOME,
           GRELBATCH.DESCRELAT,
           GJOBX.CLASSEPROCESSO,
GJOBX.CODCOLIGADA,
           CASE GJOBXEXECUCAO.STATUS
WHEN 0 THEN '0 - NONE'
WHEN 1 THEN '1 - RUNNING'
WHEN 2 THEN '2 - FINISHED'
WHEN 3 THEN '3 - CANCELED'
WHEN 4 THEN '4 - STOPPED'
WHEN 5 THEN '5 - ERROR'
WHEN 6 THEN '6 - WARNING'
WHEN 7 THEN '7 - FAILED'
ELSE 'DISABLED:'END STATUS,
           GJOBX.CODSISTEMA,
           GJOBX.CODUSUARIO,
           GJOBXEXECUCAO.DATAPROGRAMADA,
           GJOBXEXECUCAO.DATAINIEXEC,
           GJOBXEXECUCAO.DATAFIMEXEC,
           GJOBXEXECUCAO.SERVIDOR,
           CONVERT(VARCHAR(12),CONVERT(TIME,GJOBXEXECUCAO.DATAINIEXEC - GJOBXEXECUCAO.DATAPROGRAMADA)) AS 'TMPFILA',
           CONVERT(VARCHAR(12),CONVERT(TIME,GJOBXEXECUCAO.DATAFIMEXEC - GJOBXEXECUCAO.DATAINIEXEC)) AS 'TMPEXECUCAO',
           CONVERT(VARCHAR(12),CONVERT(TIME,GJOBXEXECUCAO.DATAFIMEXEC - GJOBXEXECUCAO.DATAPROGRAMADA)) AS 'TMPTOTAL',
           GJOBX.TIPORECORRENCIA,
GJOBXEXECUCAO.MENSAGEMSTATUS
FROM GJOBX (NOLOCK)
     INNER JOIN GJOBXEXECUCAO (NOLOCK) ON (GJOBX.IDJOB = GJOBXEXECUCAO.IDJOB)
     LEFT JOIN GRELBATCH (NOLOCK) ON (GRELBATCH.IDJOBX = GJOBX.IDJOB)
WHERE GJOBXEXECUCAO.DATAPROGRAMADA >= GETDATE()-1 -- tempo que executou
AND [STATUS]=1
ORDER BY GJOBX.IDJOB
DESC
GO
